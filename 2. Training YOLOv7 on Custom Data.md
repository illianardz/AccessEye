# 2. Training YOLOv7 on Custom Data
## Installing Dependencies
```python
!git clone https://github.com/WongKinYiu/yolov7
%cd yolov7
!pip install -r requirements.txt
```
## Downloading Custom Data
We used the YOLOv7 PyTorch export feature from Roboflow to obtain our custom annotated dataset and used a Jupyter notebook snippet to integrate the dataset into our Google Colab workspace.
```python
!pip install roboflow
%cd yolov7

from roboflow import Roboflow
rf = Roboflow(api_key="Zi2LVnTfSriJOC0z7Iz9")
project = rf.workspace("hacksmu-nhjks").project("dataset-hacksmu")
version = project.version(1)
dataset = version.download("yolov7")
```
## Custom Training
Due to our limited amount of time, our initial training was conducted over just 1 epoch to validate our setup and ensure the model was learning from our data. However, to increase the model's accuracy in the future, we plan to extend the training to 100-200 epochs.
```python
%cd /content/yolov7
!wget https://github.com/WongKinYiu/yolov7/releases/download/v0.1/yolov7_training.pt
```
```python
%cd /content/yolov7
!python train.py --batch 16 --cfg cfg/training/yolov7.yaml --epochs 1 --data {dataset.location}/data.yaml --weights 'yolov7_training.pt' --device 0
```
![image](https://github.com/user-attachments/assets/334a5fa5-d39d-40d6-92a2-979d0e8c2f54)
## Evaluation
Once the model was completed, we evaluated its performance on test images.

**Testing Images:**
```python
!python detect.py --weights runs/train/exp/weights/best.pt --conf 0.1 --source {dataset.location}/test/images

import glob
from IPython.display import Image, display

i = 0
limit = 10000 # max images to print
for imageName in glob.glob('/content/yolov7/runs/detect/exp2/*.jpg'): #assuming JPG
    if i < limit:
      display(Image(filename=imageName))
      print("\n")
    i = i + 1
```
_Here are some example inferences displayed on test images:_

![Untitled presentation](https://github.com/user-attachments/assets/383a5d0c-1f50-429f-97b0-ca47fb8be5fa)

## Deployment
After completing training and evaluation, we deployed our model by exporting the weights. These weights encapsulate all the learning and parameters the model uses to make predictions.
``` python
!zip -r export.zip runs/detect
!zip -r export.zip runs/train/exp/weights/best.pt
!zip export.zip runs/train/exp/*
```
